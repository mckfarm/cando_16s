library(mongolite)
library(lubridate)
m <- mongo(collection="in_cycle",db="cando",url = "mongodb://localhost")
start_time <- ymd("2022-03-02",tz="CST6CDT")
View(m)
View(m)
m$find({})
m$find('{}')
m$find('{date_time=2021-06-03 03:23:00')
m$find('{date_time: 2021-06-03 03:23:00}')
m$find('{'date_time': 2021-06-03 03:23:00}')
m$find('{"date_time": 2021-06-03 03:23:00}')
m$find('{"date_time": "2021-06-03 03:23:00"}')
m$find('{"date_time": "2021-06-03"}')
m$find('{"date_time": {date: 2021-06-03"}}')
m$find('{"date_time": {date: "2021-06-03"}}')
m$find('{"date_time": {date: 2021-06-03}}')
m$find('{"date_time":start_time}')
m$find('{"date_time":ymd("2022-03-02",tz="CST6CDT")}')
m$find('{"date_time": ymd("2022-03-02",tz="CST6CDT")}')
m$find('{date_time: ymd("2022-03-02",tz="CST6CDT")}')
m$find('{date_time: ymd("2022-03-02",tz="CST6CDT")}')
m$find('{"date_time": "2022-03-02"}')
m$find('{"date_time": { "$date" : "2017-01-01T00:00:00Z" }')
m$find('{"date_time": { "$date" : "2017-01-01T00:00:00Z" }}')
m$find('{"date_time": { "$date" : "2021-03-02T00:00:00Z" }}')
m$find('{"date_time": { "$gte" : {{ "$date" : "2021-03-02T00:00:00Z" }}}')
m$find('{"date_time": { "$gte" : {{ "$date" : "2021-03-02T00:00:00Z" }}}}')
m$find('{"date_time": { "$gte" : { "$date" : "2021-03-02T00:00:00Z" }}}')
m$find('{"date_time": { "$gte" : { "$date" : "2021-03-02" }}}')
start_time <- ISODate(ymd("2022-03-02",tz="CST6CDT"))
start_time <- ISOdate(ymd("2022-03-02",tz="CST6CDT"))
start_time <- make_date(year=2022, month=3, day=2, tz="UTC")
start_time <- make_date(year=2022, month=3, day=2, tz="UTC")
start_time <- make_date(year=2022L, month=3L, day=2L, tz="UTC")
start_time <- make_date(year=2022L, month=3L, day=2)
start_time
start_time <-"2022-03-02T08:20:00Z"
end_time <- "2022-03-02T14:30:00Z"
m$find(paste0('{"date_time": { "$gte" : { "$date" : 'start_time '}}}))
m$find(paste0('{"date_time": { "$gte" : { "$date" : 'start_time '}}}'))
m$find(paste0('{"date_time": { "$gte" : { "$date" : ' start_time '}}}' ))
paste0('{"date_time": { "$gte" : { "$date" : ' start_time '}}}' )
paste0('{"date_time": { "$gte" : { "$date" : ' start_time '}}}')
m$find(paste0('{"date_time": { "$gte" : { "$date" : ', start_time, '}}}'))
paste0('{"date_time": { "$gte" : { "$date" : ', start_time, '}}}')
m$find(paste0('{"date_time": { "$gte" : { "$date" : ', start_time, '}}}'))
m$find(paste0('{"date_time": { "$gte" : { "$date" : ',  start_time, '}}}'))
m$find(paste0('{"date_time": { "$gte" : { "$date" : ', start_time, '}}}'))
paste0('{"date_time": { "$gte" : { "$date" : ', start_time, '}}}')
paste0('{"date_time": { "$gte" : { "$date" : ', \" start_time,\"  '}}}')
paste0('{"date_time": { "$gte" : { "$date" : ', \" start_time,\"  '}}}')
paste0('{"date_time": { "$gte" : { "$date" : ', \"", start_time,\"",  '}}}')
paste("modelCheck(var\"",start_time,"\")",sep="")
paste("modelCheck("",start_time,"\")",sep="")
paste("modelCheck(\"",start_time,"\")",sep="")
paste0('{"date_time": { "$gte" : { "$date" : ', \"",start_time,"\",  '}}}')
paste("modelCheck(\"",start_time,"\")",sep="")
paste0('{"date_time": { "$gte" : { "$date" : ', \"",start_time,"\",  '}}}')
paste("modelCheck(\"",start_time,"\")",sep="")
paste0('{"date_time": { "$gte" : { "$date" : ', \"",start_time,"\",  '}}}')
paste0('{"date_time": { "$gte" : { "$date" : ', \",start_time,"\",  '}}}')
paste0('{"date_time": { "$gte" : { "$date" : ', \",start_time,"\",  '}}}')
paste0(\"World\")
paste0('{"date_time": { "$gte" : { "$date" : ', \",start_time,"\",  '}}}')
paste0(' \"World\" ')
paste0('{"date_time": { "$gte" : { "$date" : ', \",start_time,"\",  '}}}')
paste0('\"World\"')
paste0('{"date_time": { "$gte" : { "$date" : \",'start_time,"\",  '}}}')
paste0('\"World\"')
paste0('{"date_time": { "$gte" : { "$date" : \",'start_time,"\",  '}}}')
paste0('\"World\"')
paste0('{"date_time": { "$gte" : { "$date" : \",' start_time,"\",  '}}}')
paste0('\"World\"')
paste0('{"date_time": { "$gte" : { "$date" : "2022-03-02T08:20:00Z"}}}')
paste0('{"date_time": { "$gte" : { "$date" : "2022-03-02T08:20:00Z"}},{ "$lte" : "2022-03-02T14:30:00Z"}}')
m$find(paste0('{"date_time": { "$gte" : { "$date" : "2022-03-02T08:20:00Z"}},{ "$lte" : "2022-03-02T14:30:00Z"}}'))
m$find(paste0('{"date_time": { "$gte" : { "$date" : "2022-03-02T08:20:00Z"}, { "$lte" : "2022-03-02T14:30:00Z"}}'))
m$find(paste0('{"date_time": { "$gte" : { "$date" : "2022-03-02T08:20:00Z"}, "$lte" : "2022-03-02T14:30:00Z"}}'))
m$find(paste0('{"date_time": { "$gte" : { "$date" : "2022-03-02T08:20:00Z"}, "$lte" : { "$date" : "2022-03-02T14:30:00Z"}}'))
m$find(paste0('{"date_time": { "$gte" : { "$date" : "2022-03-02T08:20:00Z"}, "$lte" : { "$date" : "2022-03-02T14:30:00Z"}}}'))
mong$find(paste0('{"timestamp":{"$gte": { "$date" : { "$numberLong" : "', d, '" } } } }'))
paste0('{"timestamp":{"$gte": { "$date" : "', start_time, '" } } } ')
m$find(paste0('{"timestamp":{"$gte": { "$date" : "', start_time, '" } } } '))
start_time <- "2022-03-02T08:20:00Z"
m$find(paste0('{"timestamp":{"$gte": { "$date" : "', start_time, '" } } } '))
m$find(paste0('{"date_time":{"$gte": { "$date" : "', start_time, '" } } } '))
m$find(paste0('{"date_time":{
"$gte": { "$date" : "', start_time, '" },
"$lte": { "$date" : "', end_time, '" }}}'))
start_time <- "2022-03-02T00:00:00Z"
end_time <- "2022-03-03T00:00:00Z"
m$find(paste0('{"date_time":{
"$gte": { "$date" : "', start_time, '" },
"$lte": { "$date" : "', end_time, '" }}}'))
### packages and working directory ---------
setwd("~/Github/cando-16s/v4")
### packages and working directory ---------
setwd("~/Github/cando_16s/v4")
setwd("~/Github/cando_16s/v4")
library(qiime2R)
library(phyloseq)
library(ggplot2)
library(tidyverse)
physeq <- qza_to_phyloseq(
features="rarefied_table.qza",
tree="rooted_tree.qza",
taxonomy="taxonomy_midas.qza",
metadata = "mar01_metadata.txt"
)
physeq <- subset_taxa(physeq, !Genus=="Mitochondria" & !Genus=="Chloroplast")
# relative abundance
rel <- transform_sample_counts(physeq, function(x) x*100/sum(x))
write.csv(rel@tax_table,"all_tax.csv")
write.csv(rel@otu_table, "abundances.csv")
